/**
* vue-app-effect v1.0.4
* https://github.com/JooZh/vue-app-effect
* Released under the MIT License.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.VueAppEffect=t()}(this,function(){"use strict";var d=function(t,e){return{name:"vnode-cache",abstract:!0,props:{},data:function(){return{routerLen:0,route:{},to:{},from:{},tabBar:e,paths:[]}},computed:{},watch:{route:function(e,t){var n=this;this.to=e,this.from=t,-1===this.tabBar.findIndex(function(e){return e===n.$route.fullPath})&&(this.paths.push(e.fullPath),this.paths=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(new Set(this.paths))))}},created:function(){var e=this;this.cache={},this.routerLen=this.$router.options.routes.length,this.route=this.$route,this.to=this.$route,t.$on("reverse",function(){e.reverse()})},destroyed:function(){for(var e in this.cache){var t=this.cache[e];t&&t.componentInstance.$destroy()}},methods:{reverse:function(){var t=this,n=this.paths.pop(),e=this.$router.options.routes,a=this.tabBar.findIndex(function(e){return e===t.$route.fullPath}),o=e.findIndex(function(e){return e.path===n});-1===a&&o>=this.routerLen&&(delete window.$VueAppEffect[n],window.$VueAppEffect.count-=1);var r=-1===a?this.$route.fullPath:"";this.cache[r]&&(this.cache[n].componentInstance.$destroy(),delete this.cache[n])}},render:function(){var t=this;this.route=this.$route;var e=this.$slots.default?this.$slots.default[0]:null;if(e){var n=-1===this.tabBar.findIndex(function(e){return e===t.$route.fullPath})?this.$route.fullPath:"/tab-bar";this.cache[n]?e.componentInstance=this.cache[n].componentInstance:this.cache[n]=e,e.data.keepAlive=!0}return e}}};return{install:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.router,a=t.tabbar,o=t.common,r=void 0===o?"":o;if(n&&a){var i,p,f,u,c,s,h=new e;i="\n    .vue-app-effect-out-enter-active,\n    .vue-app-effect-out-leave-active,\n    .vue-app-effect-in-enter-active,\n    .vue-app-effect-in-leave-active {\n      will-change: transform;\n      transition: all 400ms cubic-bezier(.55,0,.1,1);\n      bottom: 0;\n      top: 0;\n      position: absolute;\n      backface-visibility: hidden;\n      perspective: 1000;\n    }\n    .vue-app-effect-out-enter {\n      opacity: 0;\n      transform: translate3d(-70%, 0, 0);\n    }\n    .vue-app-effect-out-leave-active {\n      opacity: 0 ;\n      transform: translate3d(70%, 0, 0);\n    }\n    .vue-app-effect-in-enter {\n      opacity: 0;\n      transform: translate3d(70%, 0, 0);\n    }\n    .vue-app-effect-in-leave-active {\n      opacity: 0;\n      transform: translate3d(-70%, 0, 0);\n    }\n  ",p=document.head||document.getElementsByTagName("head")[0],(f=document.createElement("style")).type="text/css",f.styleSheet?f.styleSheet.cssText=i:f.appendChild(document.createTextNode(i)),p.appendChild(f),c=h,s=a,(u=e).component("vnode-cache",d(c,s)),u.prototype.$vueAppEffect={on:function(e,t){c.$on(e,t)},back:function(){window.$VueAppEffect.paths.pop(),window.vm.$router.back({name:window.$VueAppEffect.paths.concat([]).pop()})},next:function(e){var t=e.path;if(t=0!==t.indexOf("/")?"/"+t:t,-1===e.vm.$router.options.routes.findIndex(function(e){return e.path===t})){var n=t.split("/");n.pop(),n=n.join("/");var a=e.vm.$router.options.routes.find(function(e){return e.name===n});if(!a)throw Error(n+" is not defined");var o=[{path:t,name:t,component:{extends:a.component}}];e.vm.$router.options.routes.push(o[0]),e.vm.$router.addRoutes(o)}e.vm.$router.push({name:t,params:e.params})}},function(t,i,p,n){window.addEventListener("load",function(){var e={count:0,paths:window.$VueAppEffect.paths};n&&(e[n]=9999999),window.$VueAppEffect=e}),window.$VueAppEffect={count:0,paths:[]},n&&(window.$VueAppEffect[n]=9999999);var f=!1,u=Date.now();document.addEventListener("touchend",function(){u=Date.now()}),["push","go","replace","forward","back"].forEach(function(e){var a=t[e].bind(t);t[e]=function(){f=!0;for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.apply(null,t)}}),t.beforeEach(function(t,e,n){if(/\/http/.test(t.path))window.location.href=t.path;else{var a=Number(window.$VueAppEffect[t.path]),o=Number(window.$VueAppEffect[e.path]);if(o=o||0,-1===p.findIndex(function(e){return e===t.path}))if(0<a)o<a?(i.$emit("forward",{type:"forward",isTabBar:!1,transitionName:"vue-app-effect-in"}),window.$VueAppEffect.paths.push(t.path)):(!f&&Date.now()-u<377?i.$emit("reverse",{type:"",isTabBar:!1,transitionName:"vue-app-effect-out"}):i.$emit("reverse",{type:"reverse",isTabBar:!1,transitionName:"vue-app-effect-out"}),delete window.$VueAppEffect[e.path]);else{var r=++window.$VueAppEffect.count;window.$VueAppEffect.count=r,window.$VueAppEffect[t.path]=r,i.$emit("forward",{type:"forward",isTabBar:!1,transitionName:"vue-app-effect-in"}),window.$VueAppEffect.paths.push(t.path)}else window.$VueAppEffect.paths.pop(),!f&&Date.now()-u<377?i.$emit("reverse",{type:"",isTabBar:!0,transitionName:"vue-app-effect-out"}):i.$emit("reverse",{type:"reverse",isTabBar:!0,transitionName:"vue-app-effect-out"}),delete window.$VueAppEffect[e.path],window.$VueAppEffect.paths.push(t.path);n()}}),t.afterEach(function(){f=!1})}(n,h,a,r)}else console.error("vue-app-effect need options: router, tabbar")}}});